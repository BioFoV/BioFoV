#!/bin/bash

################################################################################
#
# Qt5 clone and compilation
#
################################################################################

CPUS=4

if [ ! -d qt ]; then
  mkdir qt
fi
cd qt

# Get source
if [ ! -d src ]; then
  if git clone git://gitorious.org/qt/qt5.git src;then
    echo "cloned"
  else
    echo "clone failed"
    exit
  fi
else
  cd src
  if git pull; then
    echo "pulled"
    cd ..
  else
    echo "pull failed"
    exit
  fi
fi

cd src
./init-repository
cd ..

# Build for linux
if [ ! -d linux-build ]; then
  mkdir linux-build
fi
cd linux-build

../src/configure -prefix ../../linux-install/ -opensource -skip qtwebkit -release -nomake tests -nomake examples -static  -no-exceptions -confirm-license
make -j$CPUS
make install INSTALL_ROOT=../../linux-install

cd .. 
